---
title: "UI Toolkit ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼æ‹¡å¼µ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨UXMLã®ç´ä»˜ã‘"
emoji: "ğŸ«¥"
type: "tech"
topics:
  - "unity"
  - "uitoolkit"
published: true
published_at: "2023-09-13 06:30"
---

## 1. UI Toolkitã¨ã¯

> UI Toolkitã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆUIï¼‰ã‚’é–‹ç™ºã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½ã€ãƒªã‚½ãƒ¼ã‚¹ã€ãƒ„ãƒ¼ãƒ«ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚UI
> Toolkitã‚’ä½¿ç”¨ã—ã¦ã€Unity Editorç”¨ã®ã‚«ã‚¹ã‚¿ãƒ UIã‚„æ‹¡å¼µæ©Ÿèƒ½ã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«ã€ã‚²ãƒ¼ãƒ ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ UIã‚’é–‹ç™ºã§ãã¾ã™ã€‚
> 
> UI Toolkitã¯ã€æ¨™æº–çš„ãªWebæŠ€è¡“ã«è§¦ç™ºã•ã‚Œã¦ã„ã¾ã™ã€‚Webãƒšãƒ¼ã‚¸ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã—ãŸçµŒé¨“ãŒã‚ã‚Œã°ã€çŸ¥è­˜ã¯ç§»è¡Œå¯èƒ½ã§ã‚ã‚Šã€ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆã¯ãªã˜ã¿ãŒã‚ã‚Šã¾ã™ã€‚

[Unity - Manual: UI Toolkit](https://docs.unity3d.com/2022.3/Documentation/Manual/UIElements.html) ã‚ˆã‚Š

## 2. ã§ãã‚‹ã‚‚ã®

### ç©ºã®ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼
![](https://storage.googleapis.com/zenn-user-upload/02357d11b64e-20230912.png =300x)

ç©ºã®ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ã€ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼æ‹¡å¼µã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨UXMLã‚’ç´ä»˜ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ã“ã®ç´ä»˜ã‘æ–¹ã‚’2ç¨®é¡ç´¹ä»‹ã—ã¾ã™ã€‚
- ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
- ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®å‚ç…§

ä¸»ã«åˆ©ç”¨ã™ã‚‹ã®ã¯ **ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®å‚ç…§** ãŒã‚ˆã„ã§ã™ã€‚

## 3. ç’°å¢ƒ
- Unity 2022.3.5f1

## 4. ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼æ‹¡å¼µã‚’ä½œæˆã™ã‚‹MonoBehaviour

### Script
```cs
using UnityEngine;

public class Car : MonoBehaviour
{
    public string m_Make = "Toyota";
    public int m_YearBuilt = 1980;
    public Color m_Color = Color.black;
}
```

### ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼
![](https://storage.googleapis.com/zenn-user-upload/7bb6bfd2d819-20230912.png =300x)

## 5. ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼æ‹¡å¼µã¨UXMLã®ä½œæˆ
1. Create > Folder ã‹ã‚‰ `Editor` ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆ
2. `Editor` ãƒ•ã‚©ãƒ«ãƒ€ã§ Create > C# Script ã‹ã‚‰ `CarInspector` ã‚’ä½œæˆ
3. `CarInspector` ã‚’ä¸‹è¨˜ã®ã‚³ãƒ¼ãƒ‰ã«ã™ã‚‹
    ```cs
    using UnityEditor;
    using UnityEngine.UIElements;
    
    [CustomEditor(typeof(Car))]
    public class CarInspector : Editor
    {
        public override VisualElement CreateInspectorGUI()
        {
            var rootElement = new VisualElement();
    
            return rootElement;
        }
    }
    ```
4. Create > UI Toolkit > UI Document ã‹ã‚‰ `CarInspectorUXML` ã‚’ä½œæˆ
    ![](https://storage.googleapis.com/zenn-user-upload/ebbf9fa2d498-20230912.png =300x)

## 6. ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼æ‹¡å¼µã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨UXMLã‚’ç´ä»˜ã‘
ä¸Šè¨˜ã§ä½œæˆã—ãŸã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼æ‹¡å¼µã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨UXMLã‚’ç´ä»˜ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ã“ã®ç´ä»˜ã‘æ–¹æ³•ã¨ã—ã¦ä¸‹è¨˜ã®2ç¨®é¡ã‚ã‚Šã¾ã™ã€‚
- ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
- ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®å‚ç…§

ã“ã®2ç¨®é¡ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã™ã€‚
ä¸»ã«åˆ©ç”¨ã™ã‚‹ã®ã¯ **ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®å‚ç…§** ãŒã‚ˆã„ã§ã™ã€‚

### ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
```cs
using UnityEditor;
using UnityEngine.UIElements;

[CustomEditor(typeof(Car))]
public class CarInspector : Editor
{
    public override VisualElement CreateInspectorGUI()
    {
        var rootElement = new VisualElement();
	
	var visualTree = AssetDatabase.LoadAssetAtPath<VisualTreeAsset>("Assets/Editor/CarInspector.uxml");    // ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
        visualTree.CloneTree(rootElement);

        return rootElement;
    }
}
```

UXMLã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ãŸæ–¹æ³•ã§ã™ã€‚
`AssetDatabase.LoadAssetAtPath<VisualTreeAsset>("Assets/Editor/CarInspector.uxml")` ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä¸­ã«UXMLã®ãƒ‘ã‚¹ã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ã¾ã™ã€‚
ã“ã®å ´åˆã€**UXMLã®ãƒ‘ã‚¹ã®å¤‰æ›´ã‚„ã€ãƒ•ã‚¡ã‚¤ãƒ«åã®å¤‰æ›´ãŒã‚ã£ãŸå ´åˆã«å‹•ã‹ãªããªã‚‹ã®ã§æ°—ã‚’ä»˜ã‘ã¦ãã ã•ã„ã€‚**

### ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®å‚ç…§
```cs
using UnityEditor;
using UnityEngine.UIElements;

[CustomEditor(typeof(Car))]
public class CarInspector : Editor
{
    public VisualTreeAsset _InspectorXML;    // ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®å‚ç…§

    public override VisualElement CreateInspectorGUI()
    {
        var rootElement = new VisualElement();

        _InspectorXML.CloneTree(rootElement);

        return rootElement;
    }
}
```

ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®å‚ç…§ã—ãŸæ–¹æ³•ã§ã™ã€‚
`public VisualTreeAsset _InspectorXML;` ã§UXMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤–éƒ¨ã‹ã‚‰æŒ‡å®šã—ã¾ã™ã€‚
å¤–éƒ¨ã‹ã‚‰æŒ‡å®šã™ã‚‹ã®ã§ã€è¿½åŠ ã§ä¸‹è¨˜ã®ç´ä»˜ã‘ã®æ“ä½œãŒå¿…è¦ã§ã™ã€‚
ã“ã®å ´åˆã€**GUIDã‚’ç”¨ã„ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã®å‚ç…§ãŒè¨­å®šã•ã‚Œã¾ã™ã€‚ã“ã®ãŸã‚UXMLã®ãƒ‘ã‚¹ã®å¤‰æ›´ã‚„ã€ãƒ•ã‚¡ã‚¤ãƒ«åã®å¤‰æ›´ãŒã‚ã£ãŸå ´åˆã§ã‚‚å‚ç…§ãŒå¤–ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚**

1. Project ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‹ã‚‰ `CarInspector` ã‚’é¸æŠã™ã‚‹
2. `CarInspector` ã® Inspector ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ ã«ã‚ã‚‹ `Inspector XML` ã« `CarInspectorUXML` ã‚’è¨­å®šã™ã‚‹
    ![](https://storage.googleapis.com/zenn-user-upload/2e2429f7536b-20230912.png =300x)
    *è¨­å®šå‰*
    ![](https://storage.googleapis.com/zenn-user-upload/5ac8c462506b-20230912.png =300x)
    *è¨­å®šå¾Œ*


## 7. å‚è€ƒã‚µã‚¤ãƒˆ
- [Unity - Manual: Create a Custom Inspector](https://docs.unity3d.com/2022.3/Documentation/Manual/UIE-HowTo-CreateCustomInspector.html)